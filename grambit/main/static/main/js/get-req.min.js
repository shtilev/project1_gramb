var LastReqs,BidHash,PageBidText,Preloader,FinalDesktop=!1,FinalMobile=!1,ApiURL="https://api.grambit.biz/api/exchange/pay-requisites",PreloaderDesktop='<div class="pay-table-loader-desktop"></div><div class="pay-requisites-wait-desktop">Ожидайте получения реквизитов!</div><div class="pay-requisites-wait-dopinfo">Если вам не удается получить реквизиты, пожалуйста напишите оператору в чат.</div>',PreloaderMobile='<div class="pay-table-loader-mobile"></div><div class="pay-requisites-wait-mobile">Ожидайте получения реквизитов!</div><div class="pay-requisites-wait-dopinfo">Если вам не удается получить реквизиты, пожалуйста напишите оператору в чат.</div>';function GetFormattedDate(e){var t=e.getFullYear(),r=e.getMonth()+1,a=e.getDate(),i=e.getHours();return(a=a<10?"0"+a:a)+"."+(r=r<10?"0"+r:r)+"."+t+" "+(i=i<10?"0"+i:i)+":"+((e=e.getMinutes())<10?"0"+e:e)}function generate_qr(e){document.getElementById("qr-button").remove(),new QRCode(document.getElementById("qrcode"),{text:e,width:512,height:512,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H}),document.getElementById("qrcode").style="border: 10px solid white;"}function GetPayTableDesktop(e){if(e&&(e.pay_to||e.pay_description)&&e.get_currency_count&&e.get_currency_name&&e.id){var t=new Date(e.pay_requisites_datetime),r='<table class="paytable-desktop"><thead><tr><th colspan="2">Платежные реквизиты по заявке №'+e.id+'<br><div class="pay-requisites-dopinfo">Пожалуйста, обязательно сверьте данные реквизиты,<br> с реквизитами переданными Вам оператором в чате.</div></th></tr></thead><tbody>';return t&&(r+='<tr><td class="table-param">Дата выдачи</td><td>'+GetFormattedDate(t)+"</td></tr>"),e.get_currency_count&&(r+='<tr><td class="table-param">Сумма оплаты</td><td>'+e.get_currency_count+"</td></tr>"),e.get_currency_name&&(r+='<tr><td class="table-param">Валюта</td><td>'+e.get_currency_name+"</td></tr>"),e.pay_to&&(r+='<tr><td class="table-param">'+e.get_currency_main_req_name+"</td><td>"+e.pay_to+"</td></tr>"),e.pay_second_param&&(r+='<tr><td class="table-param">'+e.get_currency_second_req_name+"</td><td>"+e.pay_second_param+"</td></tr>"),e.pay_description&&(r+='<tr><td class="table-param">Описание оплаты</td><td>'+e.pay_description+"</td></tr>"),e.pay_to&&(r+='<tr><td class="table-param">QR Код</td><td><button id="qr-button" class="qr-button-desktop" onclick="generate_qr(\''+e.pay_to+'\')" type="button">Сгенерировать</button><div id="qrcode"></div></td></tr>'),r+"</tbody></table>"}return""}function GetPayTableMobile(e){if(e&&(e.pay_to||e.pay_description)&&e.get_currency_count&&e.get_currency_name&&e.id){var t=new Date(e.pay_requisites_datetime),r='<table class="paytable-mobile"><thead><tr><th>Платежные реквизиты по заявке №'+e.id+'<br><div class="pay-requisites-dopinfo">Пожалуйста, обязательно сверьте данные реквизиты,<br> с реквизитами переданными Вам оператором в чате.</div></th></tr></thead><tbody>';return t&&(r+='<tr><td class="table-param">Дата выдачи</td></tr><tr><td>'+GetFormattedDate(t)+"</td></tr>"),e.get_currency_count&&(r+='<tr><td class="table-param">Сумма оплаты</td></tr><tr><td>'+e.get_currency_count+"</td></tr>"),e.get_currency_name&&(r+='<tr><td class="table-param">Валюта</td></tr><tr><td>'+e.get_currency_name+"</td></tr>"),e.pay_to&&(r+='<tr><td class="table-param">'+e.get_currency_main_req_name+"</td></tr><tr><td>"+e.pay_to+"</td></tr>"),e.pay_second_param&&(r+='<tr><td class="table-param">'+e.get_currency_second_req_name+"</td></tr><tr><td>"+e.pay_second_param+"</td></tr>"),e.pay_description&&(r+='<tr><td class="table-param">Описание оплаты</td></tr><tr><td>'+e.pay_description+"</td></tr>"),e.pay_to&&(r+='<tr><td class="table-param">QR Код</td></tr><tr><td><button id="qr-button" class="qr-button-mobile" onclick="generate_qr(\''+e.pay_to+'\')" type="button">Сгенерировать</button><div id="qrcode"></div></td></tr>'),r+"</tbody></table>"}return""}function GetPayRequisites(){$.ajax({url:ApiURL,data:{hash:BidHash,bid:PageBidText},type:"GET",dataType:"json",cors:!0,contentType:"application/json",secure:!0,headers:{"Access-Control-Allow-Origin":"*"},success:function(e){var t,r=JSON.stringify(e);LastReqs!==r&&((t=document.getElementById("payblock"))&&(e.error?("not_relevant"===e.error&&(t.innerHTML='<div class="pay-requisites-error">Реквизиты не актуальны.<br>Пожалуйста, обратитесь к оператору в чат.</div>'),"pay-requisites-verification"===e.error&&(t.innerHTML='<div class="pay-requisites-error">Для уточнения порядка обмена наличных средств, обратитесь к оператору в чат.</div>'),"need_verification"===e.error&&(e.text?t.innerHTML='<div class="pay-requisites-verification">'+e.text+"</div>":t.innerHTML='<div class="pay-requisites-verification">Для получения реквизитов требуется верификация.<br>Пожалуйста, обратитесь к оператору в чат.</div>'),"cash_getted"===e.error&&(t.innerHTML='<div class="pay-requisites-verification">Для обмена наличных средств, обратитесь к оператору в чат.</div>'),"no_requisites"===e.error&&(t.innerHTML=Preloader)):e.id&&e.id.toString()===PageBidText?e&&(e.pay_to||e.pay_description)&&e.get_currency_count&&e.get_currency_name&&e.id?FinalDesktop?t.innerHTML=GetPayTableDesktop(e):FinalMobile&&(t.innerHTML=GetPayTableMobile(e)):t.innerHTML=Preloader:t.innerHTML='<div class="pay-requisites-error">Ошибка получения реквизитов.<br>Пожалуйста, обратитесь к оператору в чат.</div>'),LastReqs=r)},error:function(e){var t=document.getElementById("payblock");t&&(t.innerHTML=Preloader),LastReqs=null}})}$(document).ready((function(){var e,t,r=window.location.href.slice(0,window.location.href.indexOf("/?")),a=new URLSearchParams(window.location.search);-1!==r.indexOf("exchangestep")&&(FinalDesktop=!0),"step2"===a.get("temp")&&(FinalMobile=!0),(FinalDesktop||FinalMobile)&&(FinalDesktop?e=(e=r.match(/exchangestep\/hst\_([^\/]{35,45})/s))[1]:FinalMobile&&(e=a.get("hashed")),e&&(BidHash=e,FinalDesktop?(t=document.getElementsByClassName("xchangestep2title js_exchangestep_title"),Preloader=PreloaderDesktop):FinalMobile&&(t=document.getElementsByClassName("toptitle"),Preloader=PreloaderMobile),$('<div id="payblock" class="payblock-style">'+Preloader+"</div>").insertBefore(".merchantinst"),t&&t[0]&&0<(t=t[0].innerText).length&&-1!==t.indexOf("ID заявки")&&(PageBidText=t.replace("ID заявки","").trim(),setTimeout(GetPayRequisites,1e3),setInterval(GetPayRequisites,5e3))))}));